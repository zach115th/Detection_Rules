title: SharePoint ToolShell CVE-2025-53770 Exploitation Indicators
id: 68bbd759-daaf-4282-ab6d-9c3dc38c11d0
status: experimental
description: |
    Detects potential exploitation of CVE-2025-53770 by identifying indicators such as suspicious command lines discovered in Post-Exploitation activities.
    CVE-2025-53770 is a zero-day vulnerability in SharePoint that allows remote code execution.
references:
    - https://research.eye.security/sharepoint-under-siege/
    - https://msrc.microsoft.com/blog/2025/07/customer-guidance-for-sharepoint-vulnerability-cve-2025-53770/
author: Zachary Carter
date: 2025-07-27
tags:
    - attack.initial-access
    - attack.t1190
    - cve.2025-53770
    - detection.emerging-threats
logsource:
    category: process_creation
    product: windows
detection:
    selection_img:
        ParentImage|endswith: '\w3wp.exe'
    selection_encoded_aspx:
        - CommandLine|wide|base64offset|contains: 'spinstall.aspx'
        - CommandLine|base64|contains: 'spinstall.aspx'
        - CommandLine|wide|base64offset|contains: 'spinstall?.aspx'
        - CommandLine|base64|contains: 'spinstall?.aspx'
        - CommandLine|wide|base64offset|contains: 'spinstaller.aspx'
        - CommandLine|base64|contains: 'spinstaller.aspx'
        - CommandLine|wide|base64offset|contains: 'xxx.aspx'
        - CommandLine|base64|contains: 'xxx.aspx'
        - CommandLine|wide|base64offset|contains: '3plx.aspx'
        - CommandLine|base64|contains: '3plx.aspx'
        - CommandLine|wide|base64offset|contains: 'debug_dev.js'
        - CommandLine|base64|contains: 'debug_dev.js'
        - CommandLine|wide|base64offset|contains: 'info.js'
        - CommandLine|base64|contains: 'info.js'
        - CommandLine|wide|base64offset|contains: 'machinekey.aspx'
        - CommandLine|base64|contains: 'machinekey.aspx'
    selection_encoded_path:
        CommandLine|wide|base64offset|contains:
            - ':\PROGRA~1\COMMON~1\MICROS~1\WEBSER~1\1?\TEMPLATE\LAYOUTS'
            - ':\Program Files\Common Files\Microsoft Shared\Web Server Extensions\1?\TEMPLATE\LAYOUTS'
    selection_ioc:
        CommandLine|contains:
            - '-EncodedCommand JABiAGEAcwBlADYANABTAHQAcgBpAG4AZwAgAD0'
            - 'TEMPLATE\LAYOUTS\spinstall.aspx'
            - 'TEMPLATE\LAYOUTS\spinstall?.aspx'
            - 'TEMPLATE\LAYOUTS\spinstaller.aspx'
            - 'TEMPLATE\LAYOUTS\xxx.aspx'
            - 'TEMPLATE\LAYOUTS\3plx.aspx'
            - 'TEMPLATE\LAYOUTS\debug_dev.js'
            - 'TEMPLATE\LAYOUTS\info.js'
            - 'TEMPLATE\LAYOUTS\machinekey.aspx'
    condition: (selection_img and 1 of selection_encoded_*) or selection_ioc
falsepositives:
    - Unknown
level: high
